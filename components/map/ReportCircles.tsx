// components/map/ReportCircles.tsx
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ëª©ì 
//  - ì‚¬ìš©ì ì‹ ê³ (userAlerts)ë¥¼ ì§€ë„ì— "ì›(circle)" í˜•íƒœë¡œ í‘œì‹œ.
//  - ìœ„í—˜ë„(severity)ì— ë”°ë¼ ì›ì˜ ìƒ‰ìƒì„ ë‹¤ë¥´ê²Œ ì ìš©.
// íŠ¹ì§•
//  - react-native-amap3d ì˜ Circle ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©.
//  - store( alertsStore )ì—ì„œ userAlertsë¥¼ ë¶ˆëŸ¬ì™€ ë°˜ë³µ ë Œë”ë§.
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

import React from 'react';
import { Circle } from 'react-native-amap3d';
import { useAlerts } from '../notification/alertsStore';

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// severity(ìœ„í—˜ë„) ê°’ì— ë”°ë¼ ìƒ‰ìƒ ì§€ì •
// stroke: ì› í…Œë‘ë¦¬ ìƒ‰, fill: ì•ˆìª½ ë°˜íˆ¬ëª… ìƒ‰
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const colorOf = (sev?: 'red' | 'orange' | 'yellow') => {
  switch (sev) {
    case 'red':     // ğŸš¨ ë§¤ìš° ìœ„í—˜
      return { stroke: '#ef4444', fill: 'rgba(239,68,68,0.25)' };
    case 'orange':  // âš ï¸ ê²½ê³ 
      return { stroke: '#f59e0b', fill: 'rgba(245,158,11,0.25)' };
    case 'yellow':  // âš¡ ì£¼ì˜
      return { stroke: '#eab308', fill: 'rgba(234,179,8,0.25)' };
    default:        // ê¸°íƒ€/ë¯¸ì§€ì •
      return { stroke: '#3b82f6', fill: 'rgba(59,130,246,0.15)' };
  }
};

export default function ReportCircles() {
  // userAlerts: ì‚¬ìš©ìê°€ ë“±ë¡í•œ ì‹ ê³  ë°ì´í„° ë°°ì—´
  // ê° í•­ëª©ì€ { id, location: {lat,lng}, severity } í˜•íƒœ
  const { userAlerts } = useAlerts();

  return (
    <>
      {userAlerts.map((a) => {
        // ğŸš« ìœ„ì¹˜ë‚˜ ìœ„í—˜ë„ ì—†ëŠ” ë°ì´í„°ëŠ” ë¬´ì‹œ
        if (!a.location || !a.severity) return null;

        const { stroke, fill } = colorOf(a.severity);

        return (
          <Circle
            key={a.id}                 // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ í‚¤
            center={a.location}        // ì› ì¤‘ì‹¬ ì¢Œí‘œ { latitude, longitude }
            radius={1000}              // ë°˜ê²½(m) â†’ ì—¬ê¸°ì„  1km
            strokeWidth={2}            // í…Œë‘ë¦¬ ë‘ê»˜
            strokeColor={stroke}       // í…Œë‘ë¦¬ ìƒ‰ìƒ
            fillColor={fill}           // ë‚´ë¶€ ìƒ‰ìƒ (íˆ¬ëª…ë„ í¬í•¨)
            zIndex={10}                // ì§€ë„ ìœ„ ê²¹ì¹¨ ìš°ì„ ìˆœìœ„
          />
        );
      })}
    </>
  );
}
